<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Spatial Statistics Reading Group</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="mtheme.css" type="text/css" />
    <link rel="stylesheet" href="fonts_mtheme.css" type="text/css" />
    <link rel="stylesheet" href="my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Spatial Statistics Reading Group
## Introduction to Spatial Statistics
<html>
<div style="float:left">

</div>
<hr color='#324147' size=4px width=800px>
</html>
### <br/>Week 1: 30 October 2019

---




class: inverse, center, middle

# Introduction

---

# Taxonomies of spatial data

Spatial data are usually classified according to three main classes Cressie (1991):

* **Geostatistical data**

* **Point pattern data**

* **Areal data**

There are specific statistical analyses for each of these types of spatial data.  

---
class: inverse, center, middle

# Geostatistical data

---

# Geostatistical data

**Data that vary continuously over space, but is measured only at discrete locations.**

Consist of pairs of data `\((Y_i, x_i)\)`, where 

- `\(Y_i\)` is the value observed/measured at a fixred location `\(x_i\)`.
- `\(x_i = (x_{i1}, x_{i2})\)` where `\(x_{i1}\)` longitude (easting) and `\(x_{i2}\)` is latitude (northing). 

Examples could be rainfall, temperature, soil characteristics.

---

# Example

&lt;img src="figs/rainfall.svg" width="70%" style="display: block; margin: auto;" /&gt;

**Fig. 1:** Average rainfall over different years for the period May-June collected at 143 recording stations throughout Parana state, Brasil. 

---
class: inverse, middle, center

# Areal data

---

# Areal data

**Similar to geostatistical data, but are aggregated to an area that can have a regular or irregular shape.** 

Consist of pairs of data `\((Y_i, A_i)\)`, where 

- `\(Y_i\)` is the value registered for the area `\(A_i\)`.
- `\(A_i\)` is a specific area (polygon) in our study region. 

Examples include household income per zip-code, number of disease cases per county, state specific election results.


---

# Example

&lt;img src="figs/lipcancer.svg" width="50%" style="display: block; margin: auto;" /&gt;

**Fig. 2:** Standardised mortality ratio of lip cancer cases for the period 1975to 1986, for 56 districts in Scotland.

---
class: inverse, middle, center

# Point pattern data

---

# Point pattern data

**Consist of a set of locations `\(x_i\)` of objects/events occurring in a study region.**

In this case we are usually more concerned with the presence/absence of an event rather than the value of the measurement at a point.
 
Examples could be trees in a forest, animal nets, crimes, domiciles of new cases of a certain disease.

---

# Example

&lt;img src="figs/chorley.svg" width="70%" style="display: block; margin: auto;" /&gt;

**Fig. 3:** Chorley-Ribble data. Spatial locations of cases of cancer of the larynx and the lung and a disused industrial incinerator.

---

# Taxonomies of spatial processes

A **stochastic process** is a collection of random variables

A **spatial stochastic process** is a stochastic process in which each random variable is associated with a position in space

Two important types of spatial stochastic process:

- **discrete spatial variation**: the random variables are defined on a finite set of locations. 

- **continuous spatial variation**: the random variables are defined on a continuous spatial region, `\(A\in \mathbb{R}^2\)`

---
class: inverse, middle, center

# Geostatistics

---

# Past vs. Present

&amp;nbsp;

**Traditionally**, a self-contained methodology for spatial prediction:
- origins in the South African mining industry
- subsequently developed at Ã‰cole des Mines, Fontainebleau, France

&amp;nbsp;

**Nowadays**, that part of spatial statistics which is concerned with data obtained by (spatial) sampling of continuous spatial phenomena.

  

---
# .font60[Model-based Geostatistics (Diggle, Moyeed and Tawn, 1998)]

**The application of general principles of statistical modelling and inference to geostatistical problems**

- formulate a model for the data (and for the process);

- use likelihood-based methods of inference;

- answer the scientific question.

---
# The canonical geostatistical probelm

Given a set of measurements `\(Y_i : i = 1,\ldots,n\)` at locations `\(x_i\)` in a spatial region `\(A\)`, presumed to be (noisy) measurements of a spatially continuous phenomenon `\(S(x_i)\)`, what can we say about the realisation of `\(S(x_i)\)` throughout `\(A\)`?

&lt;img src="figs/geo_problem.png" width="50%" style="display: block; margin: auto;" /&gt;

---
# Geostatistical problems more generally

&lt;br/&gt;

1. **Design:** how to chose locations `\(x_i\)` at which to collect outcome data

2. **Estimation**: how to investigate relationship between outcome and covariates when data may be spatially correlated

3. **Prediction**: how to map (expected value of) outcome throughout the study-region.

&lt;br/&gt;

**Practical point**:

- Estimation only requires covariate information at locations `\(x_i\)`
- Prediction requires covariate information throughout the study-region.

---
# Empirical vs. Mecahnistic models

**Empirical:** models that acquire information from *data* and try to describe the observed data pattern.


**Mechanistic:** models aim to encapsulate the underlying scientific
processes that generated the data. Information is acquarire from *scientific contextual knowledge*.


If we merge them we can have  **mechanistically motivated statistical models**.

---

# .font60[Modelling prevalence of an infectious disease antibody]

`\(p(t)\rightarrow\)`  antibody prevalence at age `\(t\)` with

`\(\lambda\rightarrow\)` constant rate that controls the conversion to sero-positive

`\(\rho\rightarrow\)` rate that controls the conversion from sero-positive to sero-negative

The mechanism of sero-conversion can be defined using the following differential equation:
`$$\frac{dp}{dt}=\lambda \left\{1 - p(t)\right\} - \rho p(t)$$`
whose solution is
`$$p(t)=\frac{\lambda}{\lambda + \rho}[1-\exp{-(\lambda + \rho)t}]$$`
--
Adding an empirical submodel for `\(\lambda\)`
`$$\lambda_i=\exp(\alpha + \beta d_i+U_i)$$`
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
